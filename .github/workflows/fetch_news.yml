- name: Install dependencies
  run: python -m pip install --upgrade pip requests

- name: Run script
  env:
    NEWSDATA_API_KEY: ${{ secrets.NEWSDATA_API_KEY }}
  run: python scripts/fetch_news.py

- name: Commit and push if changed
  run: |
    git config user.name "github-actions"
    git config user.email "github-actions@github.com"
    git add data/top_news.json
    git diff --staged --quiet || (git commit -m "Update top_news.json" && git push)
